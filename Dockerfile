FROM node:alpine

ARG DATABASE_URL
ARG JWT_SECRET
ARG PORT=3000
ARG HOST=0.0.0.0
ARG JWT_EXPIRES_IN="60s"

ENV DATABASE_URL=$DATABASE_URL
ENV JWT_SECRET=$JWT_SECRET
ENV PORT=$PORT
ENV JWT_EXPIRES_IN=$JWT_EXPIRES_IN
ENV HOST=$HOST

COPY . .

RUN npm ci

RUN npm run build

EXPOSE $PORT

CMD node ./dist/server/entry.mjs
